<!doctype html>
<html>
	<head>
		<meta content="text/html; charset=UTF-8" http-equiv="content-type">
		<title>extension «iWebEchoppe miscellanea» pour Opencart: permissions\droits sur les fichiers\dossiers sous Linux</title>
		<meta name="description" content="module «Base des tests» de l'extension «iWebEchoppe miscellanea»">
		<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1">
		<meta http-equiv="Content-Language" content="fr">
		<META NAME="robots" CONTENT="noindex,nofollow">
		<meta name="googlebot" content="DIRECTIVE">
		<link rel="stylesheet" type="text/css" href="./../a-inc-cmn-all-sites/a-css/style-bdd-documents.css">
		<script type="text/javascript" src="./../a-inc-cmn-all-sites/a-js/graphic-res-combined-and-shared-by-all-the-net/GoogleUtils.js" defer></script>
	</head>

	<!-- Begin Google traduction -->
	<header>
		<div id="google_translate_element"></div>
		<script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=GoogleUtils.googleTranslateElementInit"></script>
	</header>
	<!-- End Google traduction -->

	<body>
		<header></header>

		<br><br><br>
		<h1>Aide pour résoudre des permissions\droits sur les fichiers\dossiers sous Linux</h1>

		<br><br><br>
		<h3>Introduction:</h3>
		<br>
		<p>Les permissions\privilèges sont donnés aux listes de contrôle d'accès (dites "ACL") via des droits "ugo", qui doivent être attribués à l'arborescence des répertoires et fichiers d'un site web, selon leur fonctionnalité. Certains fichiers sont exécutables, d'autres uniquement lisibles. La gestion des droits sous Linux n'est pas intuitive et nécessite une approche méthodique.</p>

		<br><br><br>
		<h3>Mnémotechnie: <span class="acronyme">UGO</span> est mon ami pour attribuer des droits!</h3>
		<br>
		<p>Dans la logique "ugo", chaque lettre représente un groupe:</p>
		<ul>
			<li><b>u</b>: Administrateur du site (ex: <i>Jean</i>), créateur unique du fichier/dossier.</li>
			<li><b>g</b>: Groupe-logiciel (ex: <code>www-data</code> pour Apache).</li>
			<li><b>o</b>: Internautes ("les autres de l'internet").</li>
		</ul>

		<br><br><br>
		<h3>Valeurs des permissions de base:</h3>
		<br>
		<p>Les droits sont attribués selon une valeur octale:</p>
		<ul>
			<li>Lecture (r): <b>4</b></li>
			<li>Écriture (w): <b>2</b></li>
			<li>Exécution (x): <b>1</b></li>
		</ul>
		<div class="note">
			<b>Attention:</b> Attribuer uniquement le droit de lecture (<code>4</code>) à <b>u</b> peut verrouiller l'accès à un dossier, car la navigation nécessite au moins <code>5</code> (<code>r+x</code>). En pratique, les permissions commencent souvent à <code>600</code> pour les fichiers.
		</div>

		<br><br><br>
		<h3>Attribution des droits selon Ugo:</h3>
		<br>
		<p><u>Prérequis:</u></p>
		<ul>
			<li>L'administrateur (ex: <i>Jean</i>) se connecte via FTP.</li>
			<li>Les hébergeurs comme IK ou OVH proposent des outils FTP/SSH pour gérer les permissions.</li>
			<li>La commande <span class="stabilo_noir">chmod</span> s'applique de manière récursive ou ciblée, souvent combinée avec <code>find</code>.</li>
		</ul>

		<p><b>Étapes à suivre:</b></p>
		<ol>
			<li>Changer le propriétaire (<code>chown -R Jean /web</code>).</li>
			<li>Modifier le groupe (<code>chgrp -R www-data /web</code>).</li>
			<li>Définir les permissions pour <b>u</b>, <b>g</b>, et <b>o</b>.</li>
		</ol>

		<br><br>
		<h4>&#10004; Bonnes pratiques pour les répertoires:</h4>
		<p>Permissions recommandées pour les répertoires (navigation, listage):</p>
		<ul>
			<li><span class="stabilo_noir">find /web -type d -exec chmod 750 {} +</span>: Accès restreint au groupe.</li>
			<li><span class="stabilo_noir">find /web -type d -exec chmod 755 {} +</span>: Accès public (si nécessaire).</li>
		</ul>

		<br>
		<h4>&#10060; À éviter pour les répertoires:</h4>
		<div class="note" style="background-color: #ffebee; border-left: 4px solid #f44336;">
			<p>À éviter: <span class="stabilo_noir"><s>chmod -R 555</s></span>: <b>Risque de verrouillage</b> (navigation impossible sans droits <code>x</code>).</p>
		</div>

		<br><br>
		<h4>&#10004; Bonnes pratiques pour les fichiers:</h4>
		<p>Permissions recommandées pour les fichiers:</p>
		<ul>
			<li><span class="stabilo_noir">find /web -type f -exec chmod 640 {} +</span>: Lecture seule pour <b>o</b>.</li>
			<li><span class="stabilo_noir">find /web -type f -exec chmod 644 {} +</span>: Lecture publique (si nécessaire).</li>
		</ul>
		<p>Pour les fichiers sensibles: <span class="stabilo_noir">chmod 600</span> (accès réservé à <b>u</b>).</p>

		<br>
		<h4>&#10060; À éviter pour les fichiers:</h4>
		<div class="note" style="background-color: #ffebee; border-left: 4px solid #f44336;">
			<p>À éviter: <span class="stabilo_noir"><s>chmod -R 444</s></span>: <b>Risque de verrouillage</b> (impossible de modifier le fichier).</p>
		</div>

		<br><br>
		<div class="section">
			<h4>Curieux? Alors voici un complément concernant la pose des droits d'exécution pour les scripts CGI/FastCGI, qui ont un bit d'eXécution, en sus des autres cas:</h4>

			<p>
				Pour qu'un script <strong>CGI</strong> ou <strong>FastCGI</strong> soit exécutable par le serveur web (comme Apache ou Nginx sous Linux), il est <span class="stabilo_noir"><strong>obligatoire</strong></span> que son <strong>bit d'exécution</strong> (<code>x</code>) soit activé dans les permissions.
				Cela signifie que la valeur octale des droits doit inclure <strong>au moins <code>1</code></strong> (pour <code>x</code>), généralement combinée avec les droits de lecture (<code>r</code>) et d'écriture (<code>w</code>) pour le propriétaire (<code>u</code>).
			</p>

			<p>
				<strong>Exemples de commandes:</strong>
			</p>
			<ul>
				<li>
					<span class="stabilo_noir"><code>chmod 750 public_html/cgi-bin/your-script.elf</code></span>:
					Autorise l'exécution par le propriétaire (<code>u</code>) et le groupe (<code>g</code>, souvent <code>www-data</code>), tout en restreignant l'accès aux autres utilisateurs (<code>o</code>).
				</li>
				<li>
					<span class="stabilo_noir"><code>chmod 755 public_html/cgi-bin/your-script.elf</code></span>:
					Permet une exécution publique (nécessaire si le script doit être accessible depuis le web).
				</li>
			</ul>

			<div class="note">
				<p>
					<strong>Pourquoi est-ce nécessaire?</strong><br>
					Le bit <code>x</code> (<code>1</code>) indique au système que le fichier est <strong>exécutable</strong>. Sans ce bit, le serveur web refusera de lancer le script, même si les droits de lecture (<code>r</code>) sont accordés.
				</p>
			</div>

			<p>
				<strong>Bonnes pratiques:</strong>
			</p>
			<ul>
				<li>
					&#10060; À éviter: <span class="stabilo_noir"><s><strong>chmod 777</strong></s></span>: cela expose le script à des risques de sécurité majeurs.
				</li>
				<li>
					<strong>Appliquez les droits récursivement</strong> aux répertoires parents si nécessaire:
					<pre><code>chmod 755 /public_html/cgi-bin/  # Pour le répertoire
chmod 750 /public_html/cgi-bin/your-script.elf  # Pour le script</code></pre>
				</li>
				<li>
					<strong>Vérifiez les permissions</strong> avec <code>ls -l</code>:
					Le résultat doit afficher <code>-rwxr-xr--</code> (pour <code>750</code>) ou <code>-rwxr-xr-x</code> (pour <code>755</code>).
				</li>
			</ul>

			<div class="note" style="background-color: #e3f2fd; border-left: 4px solid #2196F3;">
				<p>
					<strong>Note pour OpenCart:</strong><br>
					Si vos scripts CGI interagissent avec des modules personnalisés (ex: dans <code>/system/library/</code>), assurez-vous que le groupe (<code>g</code>) soit bien <code>www-data</code> pour éviter les conflits de permissions avec Apache.
				</p>
			</div>
		</div>

		<br><br>
		<h4>&#10004; Bonnes pratiques pour les scripts CGI\FastCGI:</h4>
		<p>Les scripts doivent avoir le bit d'exécution (<code>x</code>):</p>
		<ul>
			<li><span class="stabilo_noir">chmod 750 public_html/cgi-bin/your-script.elf</span>: Exécution restreinte.</li>
			<li><span class="stabilo_noir">chmod 755 public_html/cgi-bin/your-script.elf</span>: Exécution publique (si nécessaire).</li>
		</ul>

		<br>
		<h4>Héritage des permissions:</h4>
		<p>Pour appliquer les permissions du répertoire parent aux sous-répertoires:</p>
		<ul>
			<li><span class="stabilo_noir">chmod g+s /web</span>: Active l'héritage des droits pour le groupe.</li>
		</ul>

		<br><br><br>
		<h3>À savoir:</h3>
		<p>Sous Linux, une ACL est une combinaison "ugo". Un fichier\dossier ne peut appartenir qu'à <b>un seul groupe</b> et <b>une seule ACL</b> à la fois, contrairement à MS-Windows.</p>

		<br><br><br>
		<label id="REFERENCES" style="font-size: small;">
			*[1]: IK=Infomaniak; OVH="On Vous Héberge"; cgiwebhost=hébergement de fichiers *.cgi compilés permis, etc. = d'autres hébergeurs.
		</label>
		<aside></aside>
		<footer></footer>
	</body>
</html>
